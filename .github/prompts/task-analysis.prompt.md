---
mode: agent
---

### **任務分析與開發步驟建議框架**

當您有新的開發任務時，請向我提供 Azure DevOps 的 Task ID，並提出以下請求：

**您的標準化請求範本：**
```
請依據 Azure DevOps 工作項 #[請填入 Task ID]，分析此任務並建議最適合的 Copilot 開發模式與詳細的開發步驟。
```

我將會遵循以下流程，為您提供分析與建議：

#### **第一階段：任務分析 (Task Analysis)**

1.  **讀取任務內容**：我會使用 `mcp_azure_devops__get_work_item_details` 工具，讀取您提供的 Task ID 的完整內容，包含背景、工作摘要、核心邏輯、影響檔案等。
2.  **評估任務特徵**：我會根據讀取到的內容，從以下四個維度進行分析：
    *   **範圍 (Scope)**：
        *   涉及單一檔案還是多個檔案？
        *   是修改現有檔案，還是需要建立新檔案？
        *   變更的程式碼行數是多還是少？
    *   **複雜度 (Complexity)**：
        *   是簡單的邏輯修正，還是複雜的業務邏輯實作？
        *   是否需要整合外部服務（如：資料庫、第三方 API）？
        *   是否包含非同步處理、快取、錯誤處理等進階邏輯？
    *   **清晰度 (Clarity)**：
        *   任務描述是否清晰？驗收標準是否明確？
        *   影響的檔案路徑是否已提供？
    *   **相依性 (Dependencies)**：
        *   是否需要修改 DI 容器註冊？
        *   是否需要建立或修改單元測試？
        *   是否需要執行建置或測試任務來驗證？

#### **第二階段：開發模式建議 (Mode Recommendation)**

根據第一階段的分析結果，並對照 .doc\最佳實踐.md 中的指南，我會建議最適合的開發模式，並說明理由。

*   **建議 Agent Mode 的情況**：
    *   任務複雜，涉及多檔案建立與修改。
    *   需要執行多個步驟，如「實作 → 註冊依賴 → 寫測試 → 建置」。
    *   任務目標明確，但實作細節可由 AI 自主決定。
    *   **理由**：Agent Mode 的自主性與多步驟處理能力最適合從頭到尾完成一個完整的功能開發。

*   **建議 Edits Mode 的情況**：
    *   任務範圍明確且侷限在少數幾個已知檔案。
    *   變更內容具體，例如「將所有 Log.Information 改為 Log.Debug」。
    *   您希望精準控制每一次的修改，不希望 AI 自主新增或刪除檔案。
    *   **理由**：Edits Mode 提供最高的控制權，適合在限定範圍內進行精準打擊。

*   **建議 Inline Chat / Ask Mode 的情況**：
    *   任務是為了解一段程式碼、查詢用法或在**單一檔案**內進行小範圍重構。
    *   **理由**：這類模式最適合快速、就地的問答與微調，溝通成本最低。

*   **建議手動處理的情況**：
    *   任務極其簡單，如修改錯字、變數改名等。
    *   **理由**：根據《最佳實踐》，此時溝通成本大於手動執行的成本，使用 IDE 工具會更有效率。

#### **第三階段：建議開發步驟 (Suggested Steps)**

最後，我會根據建議的模式，提供一份客製化的、可執行的開發步驟計畫。

*   **若為 Agent Mode**：計畫將包含「全局檢視」、「程式碼實作」、「單元測試」和「建置驗證」等多個階段的 Prompt 範例，引導您與 Copilot 進行高效互動。
*   **若為 Edits Mode**：計畫將提供一個精準的 Prompt，明確指示要修改的檔案與變更內容。
*   **若為其他模式**：計畫將建議您如何提問或下達指令。

---

**IMPORTANT:** 請先不要產生任何程式碼，等待我確認計畫後再繼續。